import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as t,c as a,e as n}from"./app-BtuJf2rB.js";const s={},o=n(`<p>有时重启电脑后打开WSL2时，会出现<strong>参考的对象类型不支持尝试的操作</strong>的提示</p><h2 id="原因" tabindex="-1"><a class="header-anchor" href="#原因"><span>原因</span></a></h2><p>如果Winsock LSP DLL被加载到其进程中，则wsl.exe将显示此错误。 最简单的解决方案是对wsl.exe使用WSCSetApplicationCategory WinAPI调用来防止这种情况。 在幕后，该调用在HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WinSock2\\Parameters\\AppId_Catalog中为wsl.exe创建一个条目。 这告诉Windows不要将LSP DLL加载到wsl.exe进程中。</p><h2 id="解决方法" tabindex="-1"><a class="header-anchor" href="#解决方法"><span>解决方法</span></a></h2><h3 id="方法一-临时解决" tabindex="-1"><a class="header-anchor" href="#方法一-临时解决"><span>方法一(临时解决)</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>netsh winsock reset
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="方法二-永久解决" tabindex="-1"><a class="header-anchor" href="#方法二-永久解决"><span>方法二(永久解决)</span></a></h3><p>下载一个NoLsp.exe的工具，多个链接都可以</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>https://github.com/dyingsu/nolsp
https://www.proxifier.com/tmp/Test20200228/NoLsp.exe
http://file2.happyjava.cn/NoLsp.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下载完成后，以管理员权限打开PowerShell，执行如下命令：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>.<span class="token punctuation">\\</span>NoLsp.exe <span class="token punctuation">{</span>wsl.exe所在目录<span class="token punctuation">}</span>

<span class="token comment"># 例如</span>
.<span class="token punctuation">\\</span>NoLsp.exe C:<span class="token punctuation">\\</span>windows<span class="token punctuation">\\</span>system32<span class="token punctuation">\\</span>wsl.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),l=[o];function i(r,p){return t(),a("div",null,l)}const m=e(s,[["render",i],["__file","problem1.html.vue"]]),h=JSON.parse('{"path":"/problem/backend-problem/wsl2/problem1.html","title":"参考的对象类型不支持尝试的操作问题","lang":"zh-CN","frontmatter":{"title":"参考的对象类型不支持尝试的操作问题","category":"Windows","tag":["Windows","WSL2"],"description":"有时重启电脑后打开WSL2时，会出现参考的对象类型不支持尝试的操作的提示 原因 如果Winsock LSP DLL被加载到其进程中，则wsl.exe将显示此错误。 最简单的解决方案是对wsl.exe使用WSCSetApplicationCategory WinAPI调用来防止这种情况。 在幕后，该调用在HKEY_LOCAL_MACHINE\\\\SYSTEM...","head":[["meta",{"property":"og:url","content":"https://hollowlatte.github.io/Note-Book/Note-Book/problem/backend-problem/wsl2/problem1.html"}],["meta",{"property":"og:site_name","content":"Note-Book"}],["meta",{"property":"og:title","content":"参考的对象类型不支持尝试的操作问题"}],["meta",{"property":"og:description","content":"有时重启电脑后打开WSL2时，会出现参考的对象类型不支持尝试的操作的提示 原因 如果Winsock LSP DLL被加载到其进程中，则wsl.exe将显示此错误。 最简单的解决方案是对wsl.exe使用WSCSetApplicationCategory WinAPI调用来防止这种情况。 在幕后，该调用在HKEY_LOCAL_MACHINE\\\\SYSTEM..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-26T11:26:10.000Z"}],["meta",{"property":"article:author","content":"Hollow-Latte"}],["meta",{"property":"article:tag","content":"Windows"}],["meta",{"property":"article:tag","content":"WSL2"}],["meta",{"property":"article:modified_time","content":"2024-03-26T11:26:10.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"参考的对象类型不支持尝试的操作问题\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-26T11:26:10.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hollow-Latte\\",\\"url\\":\\"https://hollowlatte.github.io/Note-Book\\"}]}"]]},"headers":[{"level":2,"title":"原因","slug":"原因","link":"#原因","children":[]},{"level":2,"title":"解决方法","slug":"解决方法","link":"#解决方法","children":[{"level":3,"title":"方法一(临时解决)","slug":"方法一-临时解决","link":"#方法一-临时解决","children":[]},{"level":3,"title":"方法二(永久解决)","slug":"方法二-永久解决","link":"#方法二-永久解决","children":[]}]}],"git":{"createdTime":1711452370000,"updatedTime":1711452370000,"contributors":[{"name":"hollowlatte","email":"hollowlatte@outlook.com","commits":1}]},"readingTime":{"minutes":0.74,"words":221},"filePathRelative":"problem/backend-problem/wsl2/problem1.md","localizedDate":"2024年3月26日","excerpt":"<p>有时重启电脑后打开WSL2时，会出现<strong>参考的对象类型不支持尝试的操作</strong>的提示</p>\\n<h2>原因</h2>\\n<p>如果Winsock LSP DLL被加载到其进程中，则wsl.exe将显示此错误。\\n最简单的解决方案是对wsl.exe使用WSCSetApplicationCategory WinAPI调用来防止这种情况。\\n在幕后，该调用在HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinSock2\\\\Parameters\\\\AppId_Catalog中为wsl.exe创建一个条目。\\n这告诉Windows不要将LSP DLL加载到wsl.exe进程中。</p>","autoDesc":true}');export{m as comp,h as data};

import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as n,c as t,e as a}from"./app-CjdU_M7_.js";const i={},s=a(`<h2 id="动态日期索引" tabindex="-1"><a class="header-anchor" href="#动态日期索引"><span>动态日期索引</span></a></h2><p>按照日期的变化创建带有相应日期后缀的索引，例如user-202305、user-202306</p><p>这样的索引有利于数据的归档与处理</p><h2 id="实现动态日期索引" tabindex="-1"><a class="header-anchor" href="#实现动态日期索引"><span>实现动态日期索引</span></a></h2><p>步骤如下：</p><ol><li>创建索引的template 例如：<div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>PUT /_template/meeting

{
    &quot;index_patterns&quot;: [
        &quot;meeting-*&quot;
    ],
    &quot;aliases&quot;: {
        &quot;meeting&quot;: {}
    },
    &quot;mappings&quot;: {
        &quot;properties&quot;: {
            // keyword=====================================
            &quot;id&quot;: {
                &quot;type&quot;: &quot;keyword&quot;
            },
            &quot;meetingCode&quot;: {
                &quot;type&quot;: &quot;keyword&quot;
            },
            // 分词=======================================
            &quot;name&quot;: {
                &quot;type&quot;: &quot;text&quot;,
                &quot;analyzer&quot;: &quot;ik_max_word&quot;
            }
        }
    },
    &quot;settings&quot;: {
        &quot;number_of_shards&quot;: 1,
        &quot;number_of_replicas&quot;: 0
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>获取当前日期，在<code>meeting-</code>拼接上日期，如按照月份分索引，则为<code>meeting-202307</code> ，当使用插入API插入数据时，设置索引为<code>meeting-202307</code>，那么ES就会根据匹配到的索引模板来创建索引</li></ol><h2 id="document-api无法使用索引别名进行操作" tabindex="-1"><a class="header-anchor" href="#document-api无法使用索引别名进行操作"><span>Document API无法使用索引别名进行操作</span></a></h2><p>值得注意的是，使用<code>/{index_name}/_doc/{_id}</code>的Document操作时，<code>{index_name}</code>不能为索引别名。因为它属于单索引操作</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>alias <span class="token punctuation">[</span>meeting<span class="token punctuation">]</span> has more than one index associated <span class="token keyword">with</span> <span class="token namespace">it</span> <span class="token punctuation">[</span>meeting<span class="token operator">-</span><span class="token number">2023</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> meeting<span class="token operator">-</span><span class="token number">2023</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">,</span> meeting<span class="token operator">-</span><span class="token number">202308</span><span class="token punctuation">,</span> meeting_v2<span class="token punctuation">]</span><span class="token punctuation">,</span> 
can&#39;t execute a single index op
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>如下的操作都属于单索引操作，因此<code>{index_name}</code>都不可为索引别名</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>POST /{index_name}/_doc/{_id}

POST /{index_name}/_doc/{_id}

DELETE /{index_name}/_doc/{_id}

GET /{index_name}/_doc/{_id}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改与删除操作" tabindex="-1"><a class="header-anchor" href="#修改与删除操作"><span>修改与删除操作</span></a></h2><p>如果无法使用Document API进行操作,那么应该如何修改或删除动态日期索引的数据呢？</p><h3 id="删除操作" tabindex="-1"><a class="header-anchor" href="#删除操作"><span>删除操作</span></a></h3><p>可以使用DeleteByQuery API进行数据的删除</p><h3 id="修改操作" tabindex="-1"><a class="header-anchor" href="#修改操作"><span>修改操作</span></a></h3><ol><li>使用UpdateByQuery API进行数据的删除，由于UpdateByQuery API常常需要用到script脚本，当涉及到Document多个字段的修改时，script较为复杂</li><li>使用Search和Update Document，先Search查出数据所在的真实索引，再使用真实索引用Update Document操作修改数据</li></ol>`,17),l=[s];function o(d,c){return n(),t("div",null,l)}const u=e(i,[["render",o],["__file","create-dynamic-date-index.html.vue"]]),m=JSON.parse('{"path":"/practice-manual/elasticsearch/index/create-dynamic-date-index.html","title":"创建动态日期索引","lang":"zh-CN","frontmatter":{"title":"创建动态日期索引","author":null,"category":"Elasticsearch","tag":"Elasticsearch","description":"动态日期索引 按照日期的变化创建带有相应日期后缀的索引，例如user-202305、user-202306 这样的索引有利于数据的归档与处理 实现动态日期索引 步骤如下： 创建索引的template 例如： 获取当前日期，在meeting-拼接上日期，如按照月份分索引，则为meeting-202307 ，当使用插入API插入数据时，设置索引为meeti...","head":[["meta",{"property":"og:url","content":"https://hollowlatte.github.io/Note-Book/Note-Book/practice-manual/elasticsearch/index/create-dynamic-date-index.html"}],["meta",{"property":"og:site_name","content":"Note-Book"}],["meta",{"property":"og:title","content":"创建动态日期索引"}],["meta",{"property":"og:description","content":"动态日期索引 按照日期的变化创建带有相应日期后缀的索引，例如user-202305、user-202306 这样的索引有利于数据的归档与处理 实现动态日期索引 步骤如下： 创建索引的template 例如： 获取当前日期，在meeting-拼接上日期，如按照月份分索引，则为meeting-202307 ，当使用插入API插入数据时，设置索引为meeti..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-21T08:07:11.000Z"}],["meta",{"property":"article:author","content":"Hollow-Latte"}],["meta",{"property":"article:tag","content":"Elasticsearch"}],["meta",{"property":"article:modified_time","content":"2024-03-21T08:07:11.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"创建动态日期索引\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-21T08:07:11.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hollow-Latte\\",\\"url\\":\\"https://hollowlatte.github.io/Note-Book\\"}]}"]]},"headers":[{"level":2,"title":"动态日期索引","slug":"动态日期索引","link":"#动态日期索引","children":[]},{"level":2,"title":"实现动态日期索引","slug":"实现动态日期索引","link":"#实现动态日期索引","children":[]},{"level":2,"title":"Document API无法使用索引别名进行操作","slug":"document-api无法使用索引别名进行操作","link":"#document-api无法使用索引别名进行操作","children":[]},{"level":2,"title":"修改与删除操作","slug":"修改与删除操作","link":"#修改与删除操作","children":[{"level":3,"title":"删除操作","slug":"删除操作","link":"#删除操作","children":[]},{"level":3,"title":"修改操作","slug":"修改操作","link":"#修改操作","children":[]}]}],"git":{"createdTime":1711008431000,"updatedTime":1711008431000,"contributors":[{"name":"hollowlatte","email":"hollowlatte@outlook.com","commits":1}]},"readingTime":{"minutes":1.47,"words":442},"filePathRelative":"practice-manual/elasticsearch/index/create-dynamic-date-index.md","localizedDate":"2024年3月21日","excerpt":"<h2>动态日期索引</h2>\\n<p>按照日期的变化创建带有相应日期后缀的索引，例如user-202305、user-202306</p>\\n<p>这样的索引有利于数据的归档与处理</p>\\n<h2>实现动态日期索引</h2>\\n<p>步骤如下：</p>\\n<ol>\\n<li>创建索引的template\\n例如：<div class=\\"language-http\\" data-ext=\\"http\\" data-title=\\"http\\"><pre class=\\"language-http\\"><code>PUT /_template/meeting\\n\\n{\\n    \\"index_patterns\\": [\\n        \\"meeting-*\\"\\n    ],\\n    \\"aliases\\": {\\n        \\"meeting\\": {}\\n    },\\n    \\"mappings\\": {\\n        \\"properties\\": {\\n            // keyword=====================================\\n            \\"id\\": {\\n                \\"type\\": \\"keyword\\"\\n            },\\n            \\"meetingCode\\": {\\n                \\"type\\": \\"keyword\\"\\n            },\\n            // 分词=======================================\\n            \\"name\\": {\\n                \\"type\\": \\"text\\",\\n                \\"analyzer\\": \\"ik_max_word\\"\\n            }\\n        }\\n    },\\n    \\"settings\\": {\\n        \\"number_of_shards\\": 1,\\n        \\"number_of_replicas\\": 0\\n    }\\n}\\n</code></pre></div></li>\\n<li>获取当前日期，在<code>meeting-</code>拼接上日期，如按照月份分索引，则为<code>meeting-202307</code>\\n，当使用插入API插入数据时，设置索引为<code>meeting-202307</code>，那么ES就会根据匹配到的索引模板来创建索引</li>\\n</ol>","autoDesc":true}');export{u as comp,m as data};

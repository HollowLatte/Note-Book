---
title: ES分页查询
author:
category: Elasticsearch
tag: Elasticsearch
---

## 官方文档

[Paginate search results](https://www.elastic.co/guide/en/elasticsearch/reference/current/paginate-search-results.html#paginate-search-results)

## 分页方式对比

| 分页方式               | 简述                                                                                                                                                                                                                               | 缺点                           |
|--------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
| From&Size          | 浅分页情况下，可以考虑使用；                                                                                                                                                                                                                   | ● 默认大小限制<br/> ● 深度分页情况下，性能较差 |
| Scroll(官方不推荐)      | 基于历史快照和上一页的scroll_id，查询下一页；                                                                                                                                                                                                      | ● 快照比较占内存<br/>● 不适合实时搜索和跳页需求 |
| Search After(官方推荐) | 1. 需要排序，官方（`5.6版本`）推荐使用 **_uid** 作为排序字段和全局唯一值（注：不同版本的ES，官方文档有变动，请参考对应版本的文档。比如，`7.x版本`建议拷贝`_id`字段值到另外一个支持`doc value`的字段，用于作为排序字段）； <br/>2. 通过**实时cursor**来规避耗时和占存储的性能问题，基于上一页的结果帮助检索下一页； <br/>3. 使用search_after参数时，from的值必须为0或者-1 | ● 需要排序<br/> ● 不适合跳页需求        |

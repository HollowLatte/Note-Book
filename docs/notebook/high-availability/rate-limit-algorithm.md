---
title: 限流算法
author:
category: HA
tag: HA
---

## 固定窗口

固定窗口限流算法（Fixed Window Rate Limiting Algorithm）是一种最简单的限流算法，其原理是在固定时间窗口(单位时间)
内限制请求的数量。该算法将时间分成固定的窗口，并在每个窗口内限制请求的数量。具体来说，算法将请求按照时间顺序放入时间窗口中，并计算该时间窗口内的请求数量，如果请求数量超出了限制，则拒绝该请求。

- 优点：固定窗口算法非常简单，易于实现和理解。
- 缺点：存在明显的临界问题，比如:
  假设限流阀值为5个请求，单位时间窗口是1s,如果我们在单位时间内的前0.8-1s和1-1.2s，分别并发5个请求。虽然都没有超过阀值，但是如果算0.8-1.2s,则并发数高达10，已经超过单位时间1s不超过5阀值的定义啦。

## 滑动窗口

滑动窗口限流算法是一种常用的限流算法，用于控制系统对外提供服务的速率，防止系统被过多的请求压垮。
它将单位时间周期分为n个小周期，分别记录每个小周期内接口的访问次数，并且根据时间滑动删除过期的小周期。它可以解决固定窗口临界值的问题。

格子周期划分的越多，那么滑动窗口的滚动就越平滑，限流的统计就会越精确。

实现：可以利用Redis的zset实现滑动窗口限流

优点：

- 精度高（通过调整时间窗口的大小来实现不同的限流效果）
- 可扩展性强（可以非常容易地与其他限流算法结合使用）

缺点：

- 突发流量无法处理（无法应对短时间内的大量请求，但是一旦到达限流后，请求都会直接暴力被拒绝），需要合理调整时间窗口大小。

## 漏桶

## 令牌桶

令牌桶算法是一种基于漏桶算法的算法，它是漏桶算法的一种改进